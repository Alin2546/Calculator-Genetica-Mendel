<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ro">
<head>
    <meta charset="UTF-8" />
    <title>Calculator Legile lui Mendel</title>
    <style>
        body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9fbfd;
      color: #2c3e50;
      margin-top: 85px;
      padding: 0 0 40px;
  }
          h1 {
              text-align: center;
              margin-bottom: 30px;
              font-weight: 700;
              font-size: 2rem;
              color: #34495e;
          }
          .section {
              background: #fff;
              padding: 22px 28px;
              border-radius: 10px;
              box-shadow: 0 5px 15px rgb(0 0 0 / 0.07);
              margin-bottom: 30px;
          }
          form {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
              gap: 14px 24px;
              align-items: center;
          }
          form h2 {
              grid-column: 1 / -1;
              margin-top: 0;
              margin-bottom: 16px;
              font-weight: 700;
              font-size: 1.2rem;
              color: #2a3f54;
          }
          label {
              font-weight: 600;
              font-size: 0.9rem;
              color: #3a4a63;
              justify-self: end;
              white-space: nowrap;
          }
          input[type="text"] {
              padding: 8px 12px;
              font-size: 1rem;
              border: 1.7px solid #cbd2d9;
              border-radius: 6px;
              transition: border-color 0.25s;
              max-width: 160px;
              width: 100%;
          }
          input[type="text"]:focus {
              outline: none;
              border-color: #4a90e2;
              box-shadow: 0 0 8px rgba(74, 144, 226, 0.35);
          }
          button {
              grid-column: 1 / -1;
              max-width: 240px;
              justify-self: center;
              background-color: #4a90e2;
              border: none;
              color: white;
              font-weight: 700;
              border-radius: 7px;
              padding: 14px 0;
              cursor: pointer;
              font-size: 1.15rem;
              transition: background-color 0.3s ease;
          }
          button:hover {
              background-color: #357abd;
          }

          /* Rezultate */
          .results-section h2 {
              margin-bottom: 24px;
              color: #2a3f54;
              font-weight: 700;
              font-size: 1.4rem;
          }
          .results-section h3 {
              margin-bottom: 12px;
              font-weight: 700;
              font-size: 1.1rem;
              color: #34495e;
              border-bottom: 2px solid #4a90e2;
              padding-bottom: 4px;
          }
          p, ul {
              margin-top: 6px;
              margin-bottom: 18px;
              color: #4a5a72;
              font-size: 0.95rem;
          }
          ul {
              list-style: inside disc;
              padding-left: 18px;
          }

          .parents-genotype {
              font-size: 1.1rem;
              font-weight: 700;
              margin-bottom: 18px;
              color: #34495e;
          }
          .parents-genotype span {
              background: #e4f0fb;
              padding: 6px 14px;
              border-radius: 8px;
              border: 1.5px solid #4a90e2;
              margin: 0 6px;
              display: inline-block;
              min-width: 90px;
              text-align: center;
              letter-spacing: 0.04em;
          }
          .parents-genotype .cross {
              font-size: 1.4rem;
              color: #2980b9;
              user-select: none;
          }

          table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 30px;
              font-size: 0.9rem;
              color: #2a3f54;
          }
          th, td {
              border: 1px solid #cbd2d9;
              padding: 10px 14px;
              text-align: center;
          }
          th {
              background-color: #4a90e2;
              color: white;
              font-weight: 700;
              user-select: none;
          }
          tbody tr:nth-child(even) {
              background-color: #f5f9fe;
          }



          @media (max-width: 640px) {
              form {
                  grid-template-columns: 1fr;
              }
              label {
                  justify-self: start;
                  white-space: normal;
                  margin-bottom: 4px;
              }
              input[type="text"] {
                  max-width: 100%;
              }
              button {
                  max-width: 100%;
              }
              .parents-genotype span {
                  min-width: auto;
                  padding: 8px 12px;
                  margin: 6px 3px 6px 0;
              }
          }
         header {
    position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 56px;
  background-color: #d1e4ff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 1rem;
  box-shadow: 0 2px 4px rgb(0 0 0 / 0.1);
  z-index: 1200;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

  #menu-toggle {
      background-color: transparent;
  border: none;
  color: #004aad;
  font-size: 2rem;
  cursor: pointer;
  padding: 0.2rem 0.5rem;
  border-radius: 6px;
  transition: background-color 0.2s;
  }

  #menu-toggle:hover {
  background-color: #a8c3ff;
}

  .header-text {

    padding: 0 1rem;
    flex-grow: 1;
    display: flex;
    justify-content: center;
    gap: 1rem;
    color: #004aad;
    font-weight: 900;
    font-size: 1.4rem;
    user-select: none;
    align-items: center;
  }


.app-title {
  margin-left: auto;
  margin-right: 30px;
  margin-bottom: 20px;
  font-size: 1.6rem;
  font-weight: 900;
  background: linear-gradient(90deg, #007bff, #7c3aed, #f97316);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 6px rgba(0, 0, 0, 0.15);
  user-select: none;
  white-space: nowrap;
}

  .sidebar {
            width: 250px;
            background-color: #004aad;
            color: white;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            transition: transform 0.3s ease;
            position: fixed;
            top: 56px;
            left: 0;
            height: calc(100vh - 56px);
            transform: translateX(-100%);
            z-index: 1002;
        }

   .sidebar.show {
            transform: translateX(0);
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
        }

  #close-btn {
      font-size: 1.5rem;
      background: none;
      border: none;
      color: #555;
      cursor: pointer;
  }

        .container {
    max-width: 850px;
    margin: 30px auto;
    padding: 0 20px;
}
     .sidebar nav a {
    display: block;
    color: #e0e7ff;
    font-weight: 600;
    font-size: 1.05rem;
    padding: 8px 15px;
    text-decoration: none;
    border-radius: 6px;
    transition: background-color 0.3s ease, color 0.3s ease;
    user-select: none;
    margin-bottom: 6px;
}

.sidebar nav a:hover,
.sidebar nav a:focus {
    background-color: #3b82f6;
    color: white;
    outline: none;
    cursor: pointer;
}

.sidebar nav a.active {
    background-color: #2563eb;
    color: white;
}

.sidebar a.sustine-proiect {
    background-color: #374151;
    color: #f9fafb;
    font-weight: 600;
    text-align: center;
    padding: 0.6rem 0.8rem;
    margin-top: 1rem;
    border-radius: 8px;
    font-size: 1.05rem;
    transition: background-color 0.3s, transform 0.2s;
}

.sidebar a.sustine-proiect:hover {
    background-color: #1f2937;
    transform: scale(1.05);
    cursor: pointer;
}
        #close-btn {
  font-size: 3rem;
  color: white;
  background: none;
  border: none;
  cursor: pointer;
  position: absolute;
  top: 0.8rem;
  right: 1rem;
}
        .step-number {
  color: #d93025;
  font-weight: 700;
  font-size: 1.3rem;
  margin-right: 0.25rem;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);
}
    </style>
</head>
<body>
<header>
    <button id="menu-toggle" aria-label="Deschide meniul">‚ò∞</button>
        <div class="header-text">
            <span class="step-number">1.</span>Definirea genelor ‚Üí
            <span class="step-number">2.</span>Introducere pƒÉrin»õi ‚Üí
            <span class="step-number">3.</span>Rezultate F‚ÇÅ / F‚ÇÇ
        </div>
    <h1 class="app-title">Calculator Genetica Mendelianaüß¨</h1>
</header>

<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h2>CalculatorGenetica</h2>
        <button id="close-btn" aria-label="√énchide meniul">√ó</button>
    </div>
    <nav>
        <a th:href="@{/}">Calculator</a>
        <a th:href="@{/learning-environment}">Mediu de Invatare</a>
        <a th:href="@{/theory}">Teorie geneticƒÉ</a>
        <a th:href="@{/segregation-law}">Legea segregƒÉrii</a>
        <a th:href="@{/independent-assortment}">Asortare independentƒÉ</a>
        <a th:href="@{/bac-exercises}">Exerci»õii BAC</a>
        <a th:href="@{/contact}">Contact</a>
        <a th:href="@{/faq}">√éntrebƒÉri frecvente</a>
        <a th:href="@{/terms}">Termeni »ôi condi»õii</a>
        <a th:href="@{/donate}" class="sustine-proiect">‚ù§Ô∏è Sus»õine proiectul</a>
    </nav>
</div>
<div class="container">

    <div class="section">
        <h2>AnalizƒÉ automatƒÉ cu AI</h2>
        <p>Introdu enun»õul problemei genetice, iar AI-ul va extrage alelele »ôi genotipurile pƒÉrin»õilor:</p>
        <form method="post" th:action="@{/solve}" style="display: flex; flex-direction: column; gap: 12px;">
        <textarea name="problemStatement" rows="4" placeholder="Se √Æncruci≈üeazƒÉ un pƒÉr viguros (v), cu fructe asimetrice (A), fiind heterozigot pentru forma
fructelor, cu un pƒÉr de vigoare slabƒÉ (V) »ôi fructe sferice (a), fiind homozigot pentru ambele caractere.
√én F1 se ob»õin mai multe combina»õii de factori ereditari."
                  style="padding: 10px; border-radius: 6px; border: 1.7px solid #cbd2d9; width: 100%;" required
                  th:text="${problemStatement}"></textarea>
            <button type="submit" style="max-width: 220px; justify-self: start; margin-top: 8px;">AnalizeazƒÉ cu AI</button>
        </form>

        <div class="results-section" th:if="${aiResult}">
            <h3>Rezultatul AI</h3>
            <p><strong>Alele:</strong> <span th:text="${aiResult.alleles}"></span></p>
            <p><strong>Genotip pƒÉrinte 1:</strong> <span th:text="${aiResult.fatherGenotype}"></span></p>
            <p><strong>Genotip pƒÉrinte 2:</strong> <span th:text="${aiResult.motherGenotype}"></span></p>
        </div>
    </div>

<div class="section">
    <h2>1. Definirea genelor »ôi caracterelor</h2>
    <form method="post" th:action="@{/define-genes}" style="max-width: 900px; display: grid; grid-template-columns: 1fr; gap: 18px;">

        <h3>Caracter 1</h3>

        <div style="display: flex; gap: 20px; align-items: center;">
            <label for="dominant1" style="white-space: nowrap; width: 150px;">Alela dominantƒÉ (ex: M)</label>
            <input type="text" id="dominant1" name="dominant1" maxlength="1" required style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
            <label for="dominant1Desc" style="white-space: nowrap; width: 180px; margin-left: 30px;">Descriere (ex: mare)</label>
            <input type="text" id="dominant1Desc" name="dominant1Desc" required style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
        </div>

        <div style="display: flex; gap: 20px; align-items: center;">
            <label for="recessive1" style="white-space: nowrap; width: 150px;">Alela recesivƒÉ (ex: m)</label>
            <input type="text" id="recessive1" name="recessive1" maxlength="1" required style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
            <label for="recessive1Desc" style="white-space: nowrap; width: 180px; margin-left: 30px;">Descriere (ex: mic)</label>
            <input type="text" id="recessive1Desc" name="recessive1Desc" required style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
        </div>

        <h3 style="margin-top: 30px;">Caracter 2 (op»õional)</h3>

        <div style="display: flex; gap: 20px; align-items: center;">
            <label for="dominant2" style="white-space: nowrap; width: 150px;">Alela dominantƒÉ (ex: R)</label>
            <input type="text" id="dominant2" name="dominant2" maxlength="1" style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
            <label for="dominant2Desc" style="white-space: nowrap; width: 180px; margin-left: 30px;">Descriere (ex: galben)</label>
            <input type="text" id="dominant2Desc" name="dominant2Desc" style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
        </div>


        <div style="display: flex; gap: 20px; align-items: center;">
            <label for="recessive2" style="white-space: nowrap; width: 150px;">Alela recesivƒÉ (ex: r)</label>
            <input type="text" id="recessive2" name="recessive2" maxlength="1" style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
            <label for="recessive2Desc" style="white-space: nowrap; width: 180px; margin-left: 30px;">Descriere (ex: ro»ôu)</label>
            <input type="text" id="recessive2Desc" name="recessive2Desc" style="flex-grow: 1; padding: 8px 12px; border-radius: 6px; border: 1.7px solid #cbd2d9;" />
        </div>

        <button type="submit" style="max-width: 220px; justify-self: center; margin-top: 20px;">SalveazƒÉ genele</button>
    </form>
</div>
<div class="section" th:if="${genesDefined}">
    <h3>Gene salvate</h3>
    <ul>
        <li th:if="${dominant1}" th:text="'Alela dominantƒÉ 1: ' + ${dominant1} + ' (' + ${dominant1Desc} + ')'"></li>
        <li th:if="${recessive1}" th:text="'Alela recesivƒÉ 1: ' + ${recessive1} + ' (' + ${recessive1Desc} + ')'"></li>
        <li th:if="${dominant2}" th:text="'Alela dominantƒÉ 2: ' + ${dominant2} + ' (' + ${dominant2Desc} + ')'"></li>
        <li th:if="${recessive2}" th:text="'Alela recesivƒÉ 2: ' + ${recessive2} + ' (' + ${recessive2Desc} + ')'"></li>
    </ul>
</div>
<div th:if="${error}" style="color: red; font-weight: bold; margin-bottom: 20px;">
    <p th:text="${error}"></p>
</div>
<div class="section" th:if="${genesDefined}">
    <h2>2. Introdu genotipurile pƒÉrin»õilor (F‚ÇÄ)</h2>
    <form method="post" th:action="@{/define-parents}" style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
        <div style="display: flex; flex-direction: column;">
            <label for="parent1">PƒÉrinte 1:</label>
            <input type="text" id="parent1" name="parent1" placeholder="Ex: Aavv" maxlength="10" required />
        </div>

        <div style="font-size: 3.3rem; font-weight: 700; color: #3498db; user-select: none; margin: 0 10px;">
            √ó
        </div>

        <div style="display: flex; flex-direction: column;">
            <label for="parent2">PƒÉrinte 2:</label>
            <input type="text" id="parent2" name="parent2" placeholder="Ex: VVaa" maxlength="10" required />
        </div>

        <button type="submit" style="flex-basis: 100%; max-width: 200px; margin-top: 15px;">GenereazƒÉ F‚ÇÅ</button>
    </form>
</div>


<div class="section results-section" th:if="${parentsDefined}">
    <h2>Rezultate pentru problema curentƒÉ</h2>

    <div class="parents-genotype">
        <span th:text="${parent1}"></span>
        <span class="cross">√ó</span>
        <span th:text="${parent2}"></span>
    </div>

    <h3>Game»õii pƒÉrin»õilor (F‚ÇÄ)</h3>
    <p><strong>PƒÉrinte 1:</strong></p>
    <ul>
        <li th:each="g : ${gametes1}" th:text="${g}"></li>
    </ul>
    <p><strong>PƒÉrinte 2:</strong></p>
    <ul>
        <li th:each="g : ${gametes2}" th:text="${g}"></li>
    </ul>

    <h3>Tabel Punnett F‚ÇÅ (genotipuri)</h3>
    <table>
        <thead>
        <tr>
            <th>Game»õi PƒÉrinte 1 \ PƒÉrinte 2</th>
            <th th:each="g : ${gametes2}" th:text="${g}"></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="g1, iterStat1 : ${gametes1}">
            <th th:text="${g1}"></th>
            <td th:each="g2, iterStat2 : ${gametes2}"
                th:text="${resultsF1[iterStat1.index][iterStat2.index]}"></td>
        </tr>
        </tbody>
    </table>

    <h3>Fenotipuri F‚ÇÅ »ôi procente</h3>
    <table>
        <thead>
        <tr>
            <th>Genotip</th>
            <th>Fenotip</th>
            <th>Procent</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="row : ${phenotypesF1}">
            <td th:text="${row.genotype}"></td>
            <td th:text="${row.phenotype}"></td>
            <td th:text="${row.percentage} + '%'"></td>
        </tr>
        </tbody>
    </table>

    <h3>Genotipuri F‚ÇÅ</h3>
    <ul>
        <li th:each="g : ${genotypesF1}" th:text="${g}"></li>
    </ul>

    <div th:each="f2 : ${allF2Results}">
        <h3 th:text="'Tabel Punnett F‚ÇÇ pentru genotipul F‚ÇÅ: ' + ${f2.genotypeF1}"></h3>

        <p>Game»õi genera»õi: <span th:each="g : ${f2.gametes}" th:text="${g + ' '}"></span></p>
        <h4>Clasificare simplƒÉ F‚ÇÇ</h4>
        <ul>
            <li>
                <strong>Dublu homozigote:</strong>
                <span th:each="g : ${f2.simpleClassification['dublu_homozigot']}" th:text="${g} + ' '"></span>
                (<span th:text="${#lists.size(f2.simpleClassification['dublu_homozigot'])}"></span>)
            </li>
            <li>
                <strong>Dublu heterozigote:</strong>
                <span th:each="g : ${f2.simpleClassification['dublu_heterozigot']}" th:text="${g} + ' '"></span>
                (<span th:text="${#lists.size(f2.simpleClassification['dublu_heterozigot'])}"></span>)
            </li>
        </ul>
        <table>
            <thead>
            <tr>
                <th>Game»õi</th>
                <th th:each="g : ${f2.gametes}" th:text="${g}"></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row, rowStat : ${f2.table}">
                <th th:text="${f2.gametes[rowStat.index]}"></th>
                <td th:each="cell : ${row}" th:text="${cell}"></td>
            </tr>
            </tbody>
        </table>
        <h4>Fenotipuri F‚ÇÇ »ôi procente</h4>
        <table>
            <thead>
            <tr>
                <th>Genotip</th>
                <th>Fenotip</th>
                <th>Procent</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="p : ${f2.phenotypes}">
                <td th:text="${p.genotype}"></td>
                <td th:text="${p.phenotype}"></td>
                <td th:text="${p.percentage} + '%'"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</div>
    <script>
        const sidebar = document.getElementById("sidebar");
        const toggleBtn = document.getElementById("menu-toggle");
        const closeBtn = document.getElementById("close-btn");

        toggleBtn.addEventListener("click", () => {
            sidebar.classList.add("show");
        });

        closeBtn.addEventListener("click", () => {
            sidebar.classList.remove("show");
        });
    </script>
</body>
</html>
